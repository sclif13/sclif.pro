<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Xls on –ò–¢ –∑–∞–º–µ—Ç–∫–∏</title>
    <link>http://sclif.pro/tags/xls/index.xml</link>
    <description>Recent content in Xls on –ò–¢ –∑–∞–º–µ—Ç–∫–∏</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ru-ru</language>
    <atom:link href="http://sclif.pro/tags/xls/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>–ö–æ—Å—Ç—ã–ª—å ‚Ññ1.1 –ü–µ—Ä–µ–≤–æ–¥ DBF –≤ XLS –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ</title>
      <link>http://sclif.pro/post/2012-04-02-%D0%BA%D0%BE%D1%81%D1%82%D1%8B%D0%BB%D1%8C-%E2%84%961-1-%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4-dbf-%D0%B2-xls-%D0%B2-%D1%84%D0%BE%D0%BD%D0%BE%D0%B2%D0%BE%D0%BC-%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5/</link>
      <pubDate>Mon, 02 Apr 2012 16:11:55 +0000</pubDate>
      
      <guid>http://sclif.pro/post/2012-04-02-%D0%BA%D0%BE%D1%81%D1%82%D1%8B%D0%BB%D1%8C-%E2%84%961-1-%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4-dbf-%D0%B2-xls-%D0%B2-%D1%84%D0%BE%D0%BD%D0%BE%D0%B2%D0%BE%D0%BC-%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5/</guid>
      <description>&lt;p&gt;–ü–æ—è–≤–∏–ª–æ—Å—å –∂–µ–ª–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–π –∫–æ—Å—Ç—ã–ª—å –≤ —Ñ–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–¥–æ–µ–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è –æ–∫–Ω–∞. –ß—É—Ç—å –ø–æ–¥–ø—Ä–∞–≤–∏–º –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞, –∞ –∏–º–µ–Ω–Ω–æ —Å–¥–µ–ª–∞–µ–º –µ–≥–æ –Ω–µ–≤–∏–¥–∏–º—ã–º.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#39;–û—Ç–∫—Ä—ã–≤–∞–µ–º DBF
        cURLDBF = ConvertToURL( cDbfFileToOpen )
        oCalcDoc = StarDesktop.loadComponentFromURL( cURLDBF, &amp;quot;_blank&amp;quot;, 0, _
                Array( MakePropertyValue( &amp;quot;FilterName&amp;quot;, &amp;quot;dBase&amp;quot;),_
                MakePropertyValue( &amp;quot;FilterOptions&amp;quot;, &amp;quot;30&amp;quot; ),_
                MakePropertyValue( &amp;quot;Hidden&amp;quot;, True)) )
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>–ö–æ—Å—Ç—ã–ª—å ‚Ññ1 –ü–µ—Ä–µ–≤–æ–¥ DBF –≤ XLS</title>
      <link>http://sclif.pro/post/2012-04-02-%D0%BA%D0%BE%D1%81%D1%82%D1%8B%D0%BB%D1%8C-%E2%84%961-%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4-dbf-%D0%B2-xls/</link>
      <pubDate>Mon, 02 Apr 2012 16:04:30 +0000</pubDate>
      
      <guid>http://sclif.pro/post/2012-04-02-%D0%BA%D0%BE%D1%81%D1%82%D1%8B%D0%BB%D1%8C-%E2%84%961-%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4-dbf-%D0%B2-xls/</guid>
      <description>&lt;p&gt;–†–µ—à–∏–ª –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º–∏ –∫–æ—Å—Ç—ã–ª—è–º–∏ üôÇ –û—á–µ–Ω—å —á–∞—Å—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å—Å—è –ø–∏—Å–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–∫–∏ (–∫–æ—Å—Ç—ã–ª–∏), –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∫–∞–∫—É—é-—Ç–æ —Ä—É—Ç–∏–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É.&lt;/p&gt;

&lt;p&gt;–ò —Ç–∞–∫ –∫–æ—Å—Ç—ã–ª—å ‚Ññ1. –ü–æ—è–≤–∏–ª–∞—Å—å –∑–∞–¥–∞—á–∞ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∫—É—á—É dbf —Ñ–∞–π–ª–æ–≤ –≤ xls —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –ö–æ–Ω–µ—á–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä—É—é—Ç dbf –≤ xls, –Ω–æ –æ–Ω–∏ –ø–ª–∞—Ç–Ω—ã–µ –∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞. –ü–æ—ç—Ç–æ–º—É –≤—ã–±–æ—Ä –º–æ–π –ø–∞–ª –Ω–∞ Open Office –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Basic.&lt;/p&gt;

&lt;p&gt;–î–∞–Ω–Ω—ã–π –º–∞–∫—Ä–æ—Å –±–µ—Ä–µ—Ç —Ñ–∞–π–ª—ã dbf –∏–∑ –ø–∞–ø–∫–∏ C:\TEMP\detail\ –∏ –∫–ª–∞–¥–µ—Ç XLS –≤ C:\TEMP\detail\XLS\ . –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–≤–æ–∏ –ø—É—Ç–∏.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Sub Main

Dim NextFile As String
NextFile = Dir(&amp;quot;C:\TEMP\detail\*.dbf&amp;quot;, 0)

While NextFile &amp;amp;lt;&amp;amp;gt; &amp;quot;&amp;quot;

cDbfFileToOpen = &amp;quot;C:\TEMP\detail\&amp;quot; + NextFile
cXlsFileToSave = &amp;quot;C:\TEMP\detail\XLS\&amp;quot; + NextFile
ResultString = InStr(1, cXlsFileToSave, &amp;quot;dbf&amp;quot;)
Mid(cXlsFileToSave, ResultString, 3, &amp;quot;XLS&amp;quot;)

&#39;–û—Ç–∫—Ä—ã–≤–∞–µ–º DBF
cURLDBF = ConvertToURL( cDbfFileToOpen )
oCalcDoc = StarDesktop.loadComponentFromURL( cURLDBF, &amp;quot;_blank&amp;quot;, 0, _
Array( MakePropertyValue( &amp;quot;FilterName&amp;quot;, &amp;quot;dBase&amp;quot; ),_
MakePropertyValue( &amp;quot;FilterOptions&amp;quot;, &amp;quot;30&amp;quot; )) )

&#39;–£–¥–∞–ª—è–µ–º 2 –ø–µ—Ä–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–∞
Sheet = oCalcDoc.Sheets(0)
Sheet.Columns.removeByIndex(0, 2)

&#39;–£–¥–∞–ª—è–µ–º –µ—â–µ 4 —Å—Ç–æ–ª–±—Ü–∞
Sheet.Columns.removeByIndex(1, 2)
Sheet.Columns.removeByIndex(3, 1)
Sheet.Columns.removeByIndex(6, 1)

&#39;–ò–∑–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç —Å—Ç–æ–ª–±—Ü–æ–≤ 7 –∏ 8
Dim NumberFormats As Object
Dim NumberFormatString As String
Dim NumberFormatId As Long
Dim LocalSettings As New com.sun.star.lang.Locale

LocalSettings.Language = &amp;quot;ru&amp;quot;
LocalSettings.Country = &amp;quot;ru&amp;quot;

NumberFormats = oCalcDoc.NumberFormats
NumberFormatString = &amp;quot;# ##0,00 [$—Ä—É–±.-419];[RED]-# ##0,00 [$—Ä—É–±.-419]&amp;quot;

NumberFormatId = NumberFormats.addNew(NumberFormatString, LocalSettings)

Col = Sheet.Columns(7)
Col.NumberFormat = NumberFormatId
Col.OptimalWidth = True
&#39;–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É
Col.HoriJustify = com.sun.star.table.CellHoriJustify.CENTER

Col = Sheet.Columns(8)
Col.NumberFormat = NumberFormatId
Col.OptimalWidth = True

&#39;–ò–∑–º–µ–Ω—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
Cell = Sheet.getCellByPosition(0, 0)
Cell.String = &amp;quot;–ü–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü&amp;quot;

Cell = Sheet.getCellByPosition(1, 0)
Cell.String = &amp;quot;–í—Ç–æ—Ä–æ–π&amp;quot;

Cell = Sheet.getCellByPosition(2, 0)
Cell.String = &amp;quot;–¢—Ä–µ—Ç–∏–π&amp;quot;

Cell = Sheet.getCellByPosition(3, 0)
Cell.String = &amp;quot;–ß–µ—Ç–≤–µ—Ä—Ç—ã–π&amp;quot;

Cell = Sheet.getCellByPosition(4, 0)
Cell.String = &amp;quot;–ü—è—Ç—ã–π&amp;quot;

Cell = Sheet.getCellByPosition(5, 0)
Cell.String = &amp;quot;–®–µ—Å—Ç–æ–π&amp;quot;

Cell = Sheet.getCellByPosition(6, 0)
Cell.String = &amp;quot;–°–µ–¥—å–º–æ–π&amp;quot;

Cell = Sheet.getCellByPosition(7, 0)
Cell.String = &amp;quot;–í–æ—Å—å–º–æ–π&amp;quot;

&#39;–í—ã—Å—Ç–∞–≤–ª—è–µ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É —Å—Ç–æ–ª–±—Ü–æ–≤
For I = 0 To 7
Col = Sheet.Columns(I)
Col.OptimalWidth = True
Next I

Col = Sheet.Columns(2)
Col.Width = 5000

&#39;–°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ XLS
cURLXLS = ConvertToURL( cXlsFileToSave )
oCalcDoc.storeToURL( cURLXLS, _
Array( MakePropertyValue( &amp;quot;FilterName&amp;quot;, &amp;quot;MS Excel 97&amp;quot; ) ) )

oCalcDoc.close( True )

NextFile = Dir
Wend

End Sub

Function MakePropertyValue( Optional cName As String, Optional uValue ) As com.sun.star.beans.PropertyValue
Dim oPropertyValue As New com.sun.star.beans.PropertyValue
If Not IsMissing( cName ) Then
oPropertyValue.Name = cName
EndIf
If Not IsMissing( uValue ) Then
oPropertyValue.Value = uValue
EndIf
MakePropertyValue() = oPropertyValue
End Function
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>